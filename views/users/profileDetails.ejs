
<!-- Themefisher Icon font -->
<link rel="stylesheet" href="../theme/plugins/themefisher-font/style.css">
<!-- bootstrap.min css -->
<link rel="stylesheet" href="../theme/plugins/bootstrap/css/bootstrap.min.css">

<!-- Animate css -->
<link rel="stylesheet" href="../theme/plugins/animate/animate.css">
<!-- Slick Carousel -->
<link rel="stylesheet" href="../theme/plugins/slick/slick.css">
<link rel="stylesheet" href="../theme/plugins/slick/slick-theme.css">

<!-- Main Stylesheet -->
<link rel="stylesheet" href="../theme/css/style.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">



<style>
    .inside {
      width: 100%;
  
  
    }
  
  
    .wallet-top {
      margin-top: 140px;
      text-align: center;
      margin-right: 0px;
      margin-left: 0px;
      margin-bottom: 50px;
    }
  
    button {
      border: 0;
      transition: 0.3s;
    }
  
    h3 {
      color: #00000061;
      font-size: 13px;
    }
  
    .card span {
  
      position: absolute;
  
      bottom: 10px;
      font-weight: 300;
      font-size: 13px;
      color: rgb(0, 0, 0);
    }
  
    .card h2 {
      color: rgb(0, 0, 0);
      font-weight: 500;
    }
  
    .card i {
      position: absolute;
      right: 6px;
      bottom: 6px;
      font-size: 22px;
      color: white;
    }
  
    .wallet-top h1 {
      color: #00000061;
      font-size: 35px;
    }
  
    .wallet-top .card {
      background-image: linear-gradient(189deg, #28b840 23%, #ffffff 114%);
      width: 100%;
      height: 250px;
      box-shadow: 14px 11px 25px -9px #272b32b0;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      border-color: azure;
      position: relative;
      border: 0;
  
    }
    .form-popup {
          display: none;
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background-color: #f8f8f8;
          border-radius: 0px;
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(0, 0, 0, 0.23);
          z-index: 10000;
          padding: 40px;
          color: #000000;
          overflow-y: auto;
          max-height: 80vh;
      }
  
      .form-container {
          height: 100%;
      }
  
      .form-popup input[type="text"],
      .form-popup input[type="number"],
      .form-popup input[type="email"] {
          width: 100%;
          padding: 10px;
          margin-bottom: 15px;
          border-radius: 5px;
          border: none;
      }
  
      .form-popup .btn-group {
          display: flex;
          justify-content: flex-end;
      }
  
      .form-popup .btn {
          margin-left: 10px;
      }
  
      .form-popup::-webkit-scrollbar {
          width: 8px;
      }
  
      .form-popup::-webkit-scrollbar-track {
          background-color: #f1f1f1;
      }
  
      .form-popup::-webkit-scrollbar-thumb {
          background-color: #888;
      }
  
      .form-popup::-webkit-scrollbar-thumb:hover {
          background-color: #555;
      }
      
  
  </style>


<!DOCTYPE html>
<html lang="en">







<!-- molla/category.html  22 Nov 2019 10:02:48 GMT -->
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>FocusFrames</title>
    <meta name="keywords" content="HTML5 Template">
    <meta name="description" content="Molla - Bootstrap eCommerce Template">
    <meta name="author" content="p-themes">
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="assets/images/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/images/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/icons/favicon-16x16.png">
    <link rel="manifest" href="assets/images/icons/site.html">
    <link rel="mask-icon" href="assets/images/icons/safari-pinned-tab.svg" color="#666666">
    <link rel="shortcut icon" href="assets/images/icons/favicon.ico">
    <meta name="apple-mobile-web-app-title" content="Molla">
    <meta name="application-name" content="Molla">
    <meta name="msapplication-TileColor" content="#cc9966">
    <meta name="msapplication-config" content="assets/images/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <!-- Plugins CSS File -->
    <link rel="stylesheet" href="assets/css/bootstrap.min.css">
    <!-- Main CSS File -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/plugins/owl-carousel/owl.carousel.css">
    <link rel="stylesheet" href="assets/css/plugins/magnific-popup/magnific-popup.css">
    <link rel="stylesheet" href="assets/css/plugins/nouislider/nouislider.css">

	
</head>

<body>
    <div class="page-wrapper" style="padding: 0;">
        <header class="header"   >
            
            <div class="header-middle sticky-header" style="border-color:rgba(100, 88, 88, 0.877); border-width: 2px;">
                <div class="container" style="height: 105px;">
                    <div class="header-left">
                       

                        <a href="/" class="logo">
                            <img src="assets/images/logo.png" alt="FocusFrames Logo" width="105" height="25">
                        </a>

                        <nav class="main-nav">
                            <ul class="menu sf-arrows">
                                <li class="megamenu-container active">
                                    <a href="/" >Home</a>
                                </li>
                                <li>
                                    <a href="/shop" >Shop</a>
                                </li>
                                <li>
                                    <!-- <a href="product.html"  >Product</a> -->
                                </li>
                                <li>
									<% if (user != undefined) { %>
                                        <div class="dropdown user-dropdown ml-4">
                                            <a href="/profileDetails">
                                                <span style="font-size: 18px;"><%= user.fname %></span>
                                            </a>
                                    
                                            
                                        </div><!-- End .user-dropdown -->
                                    <% } else { %>
                                        <div class="wishlist ml-4">
                                            <a href="/login" title="Login">
                                                <div class="icon">
                                                    <!-- Add your icon here -->
                                                </div>
                                                <p></p>
                                            </a>
                                        </div>
									<%}%>
                                </li>
                            </ul><!-- End .menu -->
                        </nav><!-- End .main-nav -->
                    </div><!-- End .header-left -->

                    <div class="header-right">
                        <div class="icons-container">
                        <div class="header-search" style="color: black; padding-right: 30px;">
                            <a type="submit" class="search-toggle" role="button" title="Search"><i class="icon-search"></i></a>
                            <form action="/shop" method="get">
                                <div class="header-search-wrapper">
                                    <label for="q" class="sr-only">Search</label>
                                    <input type="text" class="form-control" id="search_input" placeholder="Search Here" name="search" >
                                </div><!-- End .header-search-wrapper -->
                            </form>
                        </div><!-- End .header-search -->
                       
                        <a id="wishlist-link" href="/wishlist">
                            <span id="wishlist-icon">&#10084;</span>
                          </a>

                          <style>
                            #wishlist-icon {
                                font-size: 24px;
                                color: rgb(24, 22, 21);
                                }

                          </style>
                          
                         
                        <div class="dropdown cart-dropdown">
                            <a href="/cart" class="dropdown-toggle" role="button"  aria-haspopup="true" aria-expanded="false" >
                                <i class="icon-shopping-cart"></i>
                                <% if (typeof user!=='undefined' && user!==null) { %>
                                <span class="cart-count"><%=(typeof count!=='undefined')?count:""%></span>
                            </a>

                            
                        </div><!-- End .cart-dropdown -->
                        <% }%>


						<% if (typeof user!=='undefined' && user!==null) { %>
							
							<div class="wishlist ml-4" >
								<a href="/logout" title="Logout">
									<div class="icon">
										 
									</div>
									<p>Log out</p>
								</a>
							</div><!-- End .compare-dropdown -->
							<% } else { %>
								<div class="wishlist ml-4">
									<a href="/login" title="Login">
										<div class="icon">
											 
										</div>
										<p>Log in</p>
									</a>
								</div><!-- End .compare-dropdown -->
							<% } %> 
                           
                        </div><!-- End .icons-container -->
                    </div><!-- End .header-right -->
                </div><!-- End .container -->
            </div><!-- End .header-middle -->
        </header><!-- End .header -->
        <!-- <hr class="header-divider"> -->
        <head>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
          </head>

          <style>
            .icons-container {
                display: flex;
                align-items: center;
                gap: 30px; /* Adjust the value as needed */
            }

            .header-divider {
                border-top: 1px solid #ddd;
                 margin-top: 20px;
                 
            }

        </style>
        </head>
     </div>  

<section class="user-dashboard page-wrapper"  >
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <ul class="list-inline dashboard-menu text-center">
            <!-- <li><a href="/dashboard">Dashboard</a></li> -->
            <li><a href="/profileOrderList">Orders</a></li>
            <li><a href="/ProfileAddress">Address</a></li>
            <li><a class="active" href="/profileDetails">Profile Details</a></li>
            <li><a href="/wallet">Transactions</a></li>

          </ul>
          <section class="user-dashboard page-wrapper"  >
            <div class="container">
              <!-- <div class="row"> -->
                <div class="dashboard-wrapper dashboard-user-profile">
                  <div class="media">

                    <div class="col-md-2">
                      <div class="pull-left text-center" href="#!">
                        <img class="media-object user-img" src="../theme/images/pp.webp" alt="Image">
                      </div>
                    </div>


                    <div class="col-md-5">
                      <center><h1>Welcome <%=user.fname%></h1></center>
                      <ul class="user-profile-list" style="margin-top: 99px;margin-left: 36px;">
                       
                        <h4>Me!</h4>
                        <li><span>Full Name:</span>
                          <%=user.fname%>
                            <%=user.lname%>
                        </li>
                        <li><span>Email:</span>
                          <%=user.email%>
                        </li>
                        <li><span>Phone:</span>
                          <%=user.mobile%>
                        </li>
                        <li>
                          <span>Edit Info:</span>
                          <i class="fas fa-edit edit-icon" onclick="openEditPopup()"></i>
                        </li>
                        <li>
                          <span>Change Password:</span>
                          <i class="fas fa-lock password-icon" onclick="openPasswordPopup()"></i>

                        </li>
                      </ul>
                    </div>

                    <div class="col-md-5">
                      <div class="col-6"> 
                         <div class="inside"> 
                          <div class="wallet-top">
                            <div class="card">
                              <a href="/wallet"><h1>MY WALLET</h1></a>
                              <h2>â‚¹<%= user.wallet %>
                              </h2>
                              <span>
                                <!-- <%= user.email %> -->
                              </span>
                            </div>
                          </div>
                        </div> 
                       </div> 
                    </div>

                  </div>
                </div>



              <!-- </div> -->
            </div>
          </section>

        </div>
      </div>
    </div>
  </section>


  <!-- Modal Popup -->
  <div id="editPopup" class="form-popup">
    <div class="form-container">
      <span class="close" onclick="closeEditPopup()">&times;</span>
      <h2>Edit Info</h2>
      <form id="editForm" onsubmit="saveInfo(); return false;">
        <label for="fname">First Name:</label>
        <input type="text" id="fname" value="<%=user.fname%>" required>

        <label for="lname">Last Name:</label>
        <input type="text" id="lname" value="<%=user.lname%>" required>
        
        <label for="email">Email:</label>
        <input type="email" id="email" value="<%=user.email%>" required>
        
        <label for="mobile">Mobile:</label>
        <input type="text" id="mobile" value="<%=user.mobile%>" required>

        <div class="message-container">
          <span id="editMessage" class="message"></span>
        </div>
        
        <div class="btn-group">
          <button type="submit" class="btn">Save</button>
          <button type="button" class="btn" onclick="closeEditPopup()">Close</button>
        </div>
      </form>
    </div>
  </div>


  <!-- password popup -->
  
  <div id="passwordPopup" style="display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background-color: #fefefe; border: 1px solid #888; width: 400px; padding: 20px; border-radius: 5px;">
    <span style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;" onclick="closePasswordPopup()">&times;</span>
    <h2 style="margin-top: 0;">Change Password</h2>
    <form id="passwordForm" onsubmit="changePassword(); return false;">
      <label for="newPassword">New Password:</label>
      <input type="password" id="newPassword" required style="width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 5px; border: 1px solid #ccc;">
      
      <label for="confirmPassword">Confirm Password:</label>
      <input type="password" id="confirmPassword" required style="width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 5px; border: 1px solid #ccc;">

      <div id="messageBlock" style="display: none; color: red; margin-bottom: 15px;"></div>

      
      <div style="display: flex; justify-content: flex-end;">
        <button type="submit" style="margin-right: 10px;">Save</button>
        <button type="button" onclick="closePasswordPopup()">Close</button>
      </div>
    </form>
  </div>




<!-- <%- include('../layouts/userFooter.ejs')%> -->


<!-- 
      Essential Scripts
      =====================================-->
  
    <!-- Main jQuery -->
    <script src="plugins/jquery/dist/jquery.min.js"></script>
    <!-- Bootstrap 3.1 -->
    <script src="plugins/bootstrap/js/bootstrap.min.js"></script>
    <!-- Bootstrap Touchpin -->
    <script src="plugins/bootstrap-touchspin/dist/jquery.bootstrap-touchspin.min.js"></script>
    <!-- Instagram Feed Js -->
    <script src="plugins/instafeed/instafeed.min.js"></script>
    <!-- Video Lightbox Plugin -->
    <script src="plugins/ekko-lightbox/dist/ekko-lightbox.min.js"></script>
    <!-- Count Down Js -->
    <script src="plugins/syo-timer/build/jquery.syotimer.min.js"></script>
  
    <!-- slick Carousel -->
    <script src="plugins/slick/slick.min.js"></script>
    <script src="plugins/slick/slick-animation.min.js"></script>
  
    <!-- Google Mapl -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCC72vZw-6tGqFyRhhg5CkF2fqfILn2Tsw"></script>
    <script type="text/javascript" src="plugins/google-map/gmap.js"></script>
  
    <!-- Main Js File -->
    <script src="js/script.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  
  
  
    <script>
      // Open the edit popup
  function openEditPopup() {
    var popup = document.getElementById("editPopup");
    popup.style.display = "block";
  }
  
  // Close the edit popup
  function closeEditPopup() {
    var popup = document.getElementById("editPopup");
    popup.style.display = "none";
  }
  
  // Save the edited info using AJAX
  function saveInfo() {
    var fname = document.getElementById("fname").value.trim();
    var lname = document.getElementById("lname").value.trim();
    var email = document.getElementById("email").value.trim();
    var mobile = document.getElementById("mobile").value.trim();
    var messageBlock = document.getElementById("editMessage");
  
    // Check for empty fields
    if (fname === '' || lname === '' || email === '' || mobile === '') {
      messageBlock.innerText = "Please fill in all the fields.";
      return;
    }
  
    // Perform AJAX request to update user info
    $.ajax({
      url: "/editInfo",
      type: "POST",
      data: { fname: fname, lname: lname, email: email, mobile: mobile },
      success: function(response) {
        // Handle success response
        messageBlock.innerText = "User info updated successfully!";
        messageBlock.style.color = "green";
        closeEditPopup();
        location.reload();
      },
      error: function(error) {
        // Handle error response
        messageBlock.innerText = "Error updating user info: " + error;
        messageBlock.style.color = "red";
        location.reload();
      }
    });
  }
  
  
    </script>
  
  
  <script>
  
    // Open the password popup
  function openPasswordPopup() {
    var popup = document.getElementById("passwordPopup");
    popup.style.display = "block";
  }
  
  // Close the password popup
  function closePasswordPopup() {

    var popup = document.getElementById("passwordPopup");
    popup.style.display = "none";
  }
  
  // Save the new password using AJAX
  function changePassword() {
    const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_+\-=[\]{};':"\\|,.<>/?]).{8,}$/;

    var newPassword = document.getElementById("newPassword").value.trim();
    var confirmPassword = document.getElementById("confirmPassword").value.trim();
    var messageBlock = document.getElementById("messageBlock");
  
    // Validate that the new password and confirm password match
    if (newPassword !== confirmPassword || newPassword === '') {
      messageBlock.innerText = "New password and confirm password do not match or cannot be empty.";
      messageBlock.style.display = "block";
      return;
    }
    if (!newPassword.match(passwordRegex)) {
      messageBlock.innerText = "Password Should contain atleat 8 letters one number and a special chara.";
      messageBlock.style.display = "block";
      return;
    }
  
  
    // Perform AJAX request to update the password
    $.ajax({
      url: "/editPassword",
      type: "POST",
      data: { newPassword: newPassword },
      success: function(response) {
        // Handle success response
        messageBlock.innerText = "Password updated successfully!";
        messageBlock.style.color = "green";
        messageBlock.style.display = "block";
        setTimeout(function() {
      closePasswordPopup();
    }, 3000);
      },
      error: function(error) {
        // Handle error response
        messageBlock.innerText = "Error updating password: " + error;
        messageBlock.style.color = "red";
        messageBlock.style.display = "block";
        console.error("Error updating password:", error);
      }
    });
  }
  
  </script>
  